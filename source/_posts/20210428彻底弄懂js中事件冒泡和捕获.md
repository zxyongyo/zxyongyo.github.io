---
title: å½»åº•å¼„æ‡‚ jsä¸­äº‹ä»¶å†’æ³¡å’Œæ•è·ğŸˆ
abbrlink: 81781fa3
date: 2021-04-28 10:30:10
categories: å‰ç«¯
tags: 
  - JS
  - å‰ç«¯
keywords:  js,äº‹ä»¶,å†’æ³¡æ•è·
description: å½»åº•å¼„æ‡‚jsä¸­äº‹ä»¶å†’æ³¡å’Œæ•è·
cover: https://gitee.com/zxyong/blog-image/raw/master/img/20210428143539.webp
---

## äº‹ä»¶è§¦å‘ç»å†çš„ä¸‰ä¸ªé˜¶æ®µ

1. é¦–å…ˆæˆ‘ä»¬è¦å¼„æ¸…æ¥šå½“ä¸€ä¸ªdomäº‹ä»¶è¢«è§¦å‘æ—¶ï¼Œå®ƒä¸ä»…ä»…æ˜¯å•çº¯åœ°åœ¨è‡ªèº«å¯¹è±¡ä¸Šè§¦å‘ä¸€æ¬¡ï¼Œè€Œæ˜¯ç»å†äº†ä¸‰ä¸ªä¸åŒçš„é˜¶æ®µï¼šğŸ‘‡
   1ï¼‰**æ•è·é˜¶æ®µ**ï¼šä»æ–‡æ¡£çš„æ ¹èŠ‚ç‚¹`document`åˆ°è§¦å‘äº‹ä»¶çš„å¯¹è±¡ï¼Œ<font color="red">ä»å¤–å‘å†…æ•è·äº‹ä»¶å¯¹è±¡</font>ï¼›
   2ï¼‰**ç›®æ ‡é˜¶æ®µ**ï¼šåˆ°è¾¾ç›®æ ‡äº‹ä»¶ä½ç½®ï¼Œè§¦å‘äº‹ä»¶ï¼›
   3ï¼‰**å†’æ³¡é˜¶æ®µ**ï¼šå†ä»ç›®æ ‡äº‹ä»¶ä½ç½®å¾€æ–‡æ¡£çš„æ ¹èŠ‚ç‚¹æ–¹å‘å›æº¯ï¼Œ<font color="red">ä»å†…å‘å¤–å†’æ³¡äº‹ä»¶å¯¹è±¡</font>ã€‚

2. ä¸‹é¢æ˜¯ [w3cè§£é‡Šäº‹ä»¶æµ](https://www.w3.org/TR/DOM-Level-3-Events/#event-flow 'w3cäº‹ä»¶æµ') çš„å›¾ï¼š
   ![äº‹ä»¶æµ](https://gitee.com/zxyong/blog-image/raw/master/img/20210428110115.jpg 'äº‹ä»¶æµ')

## å†’æ³¡å’Œæ•è·
1. å½“æˆ‘ä»¬æ³¨å†Œä¸€ä¸ªäº‹ä»¶æ—¶ï¼Œäº‹ä»¶é»˜è®¤ä½¿ç”¨å†’æ³¡äº‹ä»¶æµï¼Œä¸ä½¿ç”¨æ•è·äº‹ä»¶æµã€‚

   ```js
   element.addEventListener(event, listener, useCapture)
   ```

   **eventï¼š**å¿…é¡»ã€‚å­—ç¬¦ä¸²ï¼ŒæŒ‡å®š[äº‹ä»¶ç±»å‹](https://developer.mozilla.org/zh-CN/docs/Web/Events 'äº‹ä»¶å‚è€ƒ|MDN')ã€‚
   **listenerï¼š**å¿…é¡»ã€‚ä¸€ä¸ªå®ç°äº† `EventListener` æ¥å£çš„å¯¹è±¡ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°
   **useCaptureï¼š**å¯é€‰ã€‚å¸ƒå°”å€¼ï¼ŒæŒ‡å®šäº‹ä»¶æ˜¯å¦åœ¨æ•è·æˆ–å†’æ³¡é˜¶æ®µæ‰§è¡Œã€‚`false`ä¸ºå†’æ³¡ï¼ˆé»˜è®¤ï¼‰ï¼Œ`true`ä¸ºæ•è·ã€‚ 

2. ä¸‹é¢åœ¨ä»£ç ä¸­éªŒè¯ï¼Œç›´æ¥é™„ä¸Šå…¨éƒ¨ä»£ç ã€‚ï¼ˆå¯ä»¥ç²˜åˆ°è‡ªå·±ç¼–è¾‘å™¨ä¸­è¿è¡Œã€å°è¯•ä¸€ä¸‹ï¼‰

   ```html
   <html lang="en">
   <head>
     <meta charset="UTF-8">
     <title>event</title>
     <style>
       #one {
         width: 600px;
         height: 600px;
         background-color: green;
       }
       #two {
         width: 400px;
         height: 400px;
         background-color: yellow;
       }
       #three {
         width: 200px;
         height: 200px;
         background-color: deepskyblue;
       }
     </style>
   </head>
   
   <body>
     <div id="one">one
       <div id="two">two
         <div id="three">three</div>
       </div>
     </div>
   
     <script>
       var one = document.getElementById('one')
       var two = document.getElementById('two')
       var three = document.getElementById('three')
   
       one.addEventListener('click', function () {
         console.log('oneæ•è·')
       }, true)
       two.addEventListener('click', function () {
         console.log('twoæ•è·')
       }, true)
       three.addEventListener('click', function () {
         console.log('threeæ•è·')
       }, true)
   
       one.addEventListener('click', function () {
         console.log('oneå†’æ³¡')
       }, false)
       two.addEventListener('click', function () {
         console.log('twoå†’æ³¡')
       }, false)
       three.addEventListener('click', function () {
         console.log('threeå†’æ³¡')
       }, false)
     </script>
   </body>
   </html>
   ```

3. å½“æˆ‘ä»¬ç‚¹å‡»threeæ—¶ï¼Œå¯ä»¥çœ‹åˆ°ç¡®å®æ˜¯å…ˆç”±å¤–å‘å†…äº‹ä»¶æ•è·ï¼Œä¸€ç›´åˆ°äº‹å‘å…ƒç´ ï¼Œå†ç”±å†…å‘å¤–å†’æ³¡åˆ°æ ¹èŠ‚ç‚¹ä¸Šã€‚
   ![jsäº‹ä»¶](https://gitee.com/zxyong/blog-image/raw/master/img/20210428110353.png 'å†’æ³¡&æ•è·')
   
4. å¦‚æœä¸€ä¸ªå…ƒç´ æ—¢æ³¨å†Œäº†å†’æ³¡äº‹ä»¶ï¼Œä¹Ÿæ³¨å†Œäº†æ•è·äº‹ä»¶ï¼Œåˆ™æŒ‰ç…§æ³¨å†Œé¡ºåºæ‰§è¡Œã€‚
   æˆ‘ä»¬ä¿®æ”¹ä»£ç æŠŠå†’æ³¡äº‹ä»¶æ”¾åœ¨æ•è·äº‹ä»¶ä¹‹å‰ï¼š
   
   ```js
       one.addEventListener('click', function(){
         console.log('oneå†’æ³¡')
       }, false)
       two.addEventListener('click', function(){
         console.log('twoå†’æ³¡')
       }, false)
       three.addEventListener('click', function(){
         console.log('threeå†’æ³¡')
       }, false)
   		
       one.addEventListener('click', function(){
         console.log('oneæ•è·')
       }, true)
       two.addEventListener('click', function(){
         console.log('twoæ•è·')
       }, true)
       three.addEventListener('click', function(){
         console.log('threeæ•è·')
       }, true)
   ```
   
   å†ç‚¹å‡»threeï¼Œå¯ä»¥çœ‹åˆ°è¿™æ¬¡threeå…ˆæ˜¯å…ˆå†’æ³¡åæ•è·çš„ï¼Œç”±æ­¤å¯è§ä¸€ä¸ªå…ƒç´ åŒæ—¶æ³¨å†Œäº†å†’æ³¡å’Œæ•è·äº‹ä»¶ï¼Œåˆ™ä¼šæŒ‰ç…§æ³¨å†Œé¡ºåºæ‰§è¡Œã€‚
   
   ![jsäº‹ä»¶](https://gitee.com/zxyong/blog-image/raw/master/img/20210428110502.png 'å†’æ³¡&æ•è·')

## é˜»æ­¢äº‹ä»¶å†’æ³¡
- åœ¨å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¹¶ä¸éœ€è¦å…ƒç´ ç»‘å®šçš„äº‹ä»¶å‘å¤–å†’æ³¡ï¼Œè¿™æ—¶æˆ‘ä»¬å°±è¦é˜»æ­¢äº‹ä»¶çš„å†’æ³¡ã€‚
  é˜»æ­¢å†’æ³¡ï¼šw3cçš„æ–¹æ³•æ˜¯e.stopPropagation()ï¼ŒIEåˆ™æ˜¯ä½¿ç”¨e.cancelBubble = trueï¼›
  æˆ‘ä»¬å†æ¬¡ä¿®æ”¹ä»£ç ï¼Œé˜»æ­¢threeçš„äº‹ä»¶å†’æ³¡ï¼š

  ```js
  three.addEventListener('click', function(event){
    console.log('threeå†’æ³¡')
    var e = event || window.event; // firefoxä¸‹window.eventä¸ºnull, IEä¸‹eventä¸ºnull
    // é˜»æ­¢å†’æ³¡
    if(e.stopPropagation){
      e.stopPropagation()	//å…¶ä»–æµè§ˆå™¨
    }else{
      e.cancelBubble = true //IEæµè§ˆå™¨
    }			
  }, false)
  ```

- ä¿®æ”¹å®Œä»£ç åæˆ‘ä»¬å†æ¬¡ç‚¹å‡»threeï¼Œå¯ä»¥çœ‹åˆ°threeçš„ç‚¹å‡»äº‹ä»¶è§¦å‘åå°±åœæ­¢ç»§ç»­å‘å¤–å†’æ³¡äº†ï¼›

  ![jsäº‹ä»¶](https://gitee.com/zxyong/blog-image/raw/master/img/20210428110554.png 'å†’æ³¡&æ•è·')

## äº‹ä»¶å§”æ‰˜

- äº†è§£äº†JavaScriptä¸­äº‹ä»¶çš„å†’æ³¡å’Œæ•è·åï¼Œæˆ‘å°±å¯ä»¥åˆ©ç”¨jsçš„è¿™ç§æœºåˆ¶å®Œæˆä¸€äº›ä»£ç ä¸Šçš„ä¼˜åŒ–äº†ã€‚

  ä¾‹å¦‚ç°åœ¨æœ‰è¿™æ ·çš„ä¸€æ®µä»£ç ğŸ‘‡

  ```html
  <ul id="list">
    <li>item 1</li>
    <li>item 2</li>
    <li>item 3</li>
    <li>item 4</li>
    ......
  </ul>
  ```

  æˆ‘ä»¬éœ€è¦ç»™ä¸€ä¸ªæœ‰å¾ˆå¤šå­å…ƒç´ çš„åˆ—è¡¨ä¸­çš„æ¯ä¸€ä¸ª`li`ç»‘å®šä¸€ä¸ªäº‹ä»¶ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥æ‰‹åŠ¨ç»™æ¯ä¸ª`li`ç»‘å®šäº‹ä»¶ï¼Œä¸ä»…éå¸¸çš„éº»çƒ¦ğŸ¤®ï¼Œè€Œä¸”ä¹Ÿä¼šé€ æˆå¾ˆå¤§çš„èµ„æºæµªè´¹ã€‚

  è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨<font color='red'>äº‹ä»¶å†’æ³¡æœºåˆ¶</font>å°†ç›‘å¬äº‹ä»¶åªç»‘å®šåœ¨çˆ¶å…ƒç´ `ul`ä¸Šé¢ï¼Œå½“äº‹ä»¶è§¦å‘æ—¶å†åˆ¤æ–­è§¦å‘äº‹ä»¶çš„ç›®æ ‡å…ƒç´ ï¼Œæ¥å®Œæˆæˆ‘ä»¬çš„æ“ä½œã€‚

  ```js
  var list = document.getElementById('list')
  list.addEventListener('click', function(e) {
    // å…¼å®¹æ€§å¤„ç†
    var event = e || window.event;
    var target = event.target || event.srcElement;
    // åˆ¤æ–­æ˜¯ä¸æ˜¯ç›®æ ‡å…ƒç´ 
    if(target.nodeName.toLowerCase() === 'li') {
      console.log(target.innerHTML)
    }
  })
  ```

  è¿™æ ·å½“`#list`ä¸‹çš„`li`è¢«ç‚¹å‡»åæˆ‘ä»¬å°±å¯ä»¥è·å–åˆ°è¢«ç‚¹å‡»çš„`li`å®Œæˆæˆ‘ä»¬çš„æ“ä½œäº†ğŸ¤—ã€‚





